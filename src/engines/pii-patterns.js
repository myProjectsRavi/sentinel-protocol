const PATTERN_DEFINITIONS = [
  {
    id: 'credit_card_generic',
    severity: 'critical',
    regex: /\b(?:\d[ -]*?){13,19}\b/g,
    validator: 'luhn',
    keywords: ['card', 'visa', 'mastercard', 'amex', 'payment'],
  },
  { id: 'iban', severity: 'high', regex: /\b[A-Z]{2}\d{2}[A-Z0-9]{11,30}\b/g, keywords: ['iban'] },
  { id: 'swift_bic', severity: 'high', regex: /\b[A-Z]{6}[A-Z0-9]{2}([A-Z0-9]{3})?\b/g, keywords: ['swift', 'bic'] },
  { id: 'routing_number_us', severity: 'high', regex: /\b\d{9}\b/g, keywords: ['routing'] },
  { id: 'ein_us', severity: 'critical', regex: /\b\d{2}-\d{7}\b/g, keywords: ['ein', 'employer'] },
  { id: 'ssn_us', severity: 'critical', regex: /\b(?!000|666|9\d\d)\d{3}-\d{2}-\d{4}\b/g, keywords: ['ssn', 'social'] },
  { id: 'itin_us', severity: 'critical', regex: /\b9\d{2}-\d{2}-\d{4}\b/g, keywords: ['itin'] },
  { id: 'sin_canada', severity: 'critical', regex: /\b\d{3}[ -]?\d{3}[ -]?\d{3}\b/g, validator: 'sin', keywords: ['sin', 'canada'] },
  { id: 'nino_uk', severity: 'high', regex: /\b[A-CEGHJ-PR-TW-Z]{2}\d{6}[A-D]\b/g, keywords: ['nino'] },
  { id: 'pan_india', severity: 'high', regex: /\b[A-Z]{5}\d{4}[A-Z]\b/g, keywords: ['pan'] },
  { id: 'aadhaar_india', severity: 'critical', regex: /\b\d{4}[ -]?\d{4}[ -]?\d{4}\b/g, keywords: ['aadhaar', 'uidai'] },
  { id: 'passport_us', severity: 'critical', regex: /\b\d{9}\b/g, keywords: ['passport', 'usa'] },
  { id: 'passport_india', severity: 'critical', regex: /\b[A-Z][0-9]{7}\b/g, keywords: ['passport', 'india'] },
  { id: 'medicare_mbi', severity: 'high', regex: /\b[1-9][A-Z0-9][A-Z]\d[A-Z0-9]\d[A-Z0-9]{4}\b/g, keywords: ['medicare', 'mbi'] },
  { id: 'npi_us', severity: 'high', regex: /\b\d{10}\b/g, validator: 'npi', keywords: ['npi', 'provider'] },
  { id: 'vin', severity: 'medium', regex: /\b[A-HJ-NPR-Z\d]{17}\b/g, keywords: ['vin'] },
  { id: 'abn_au', severity: 'high', regex: /\b\d{2}[ ]?\d{3}[ ]?\d{3}[ ]?\d{3}\b/g, keywords: ['abn'] },
  { id: 'tfn_au', severity: 'high', regex: /\b\d{3}[ ]?\d{3}[ ]?\d{3}\b/g, keywords: ['tfn', 'tax'] },
  { id: 'acn_au', severity: 'high', regex: /\b\d{3}[ ]?\d{3}[ ]?\d{3}\b/g, keywords: ['acn'] },
  { id: 'nhs_number_uk', severity: 'high', regex: /\b\d{3}[ ]?\d{3}[ ]?\d{4}\b/g, validator: 'nhs', keywords: ['nhs'] },

  { id: 'openai_api_key', severity: 'critical', regex: /\bsk-(?:proj-)?[A-Za-z0-9_-]{20,}\b/g, keywords: ['openai', 'sk-'] },
  { id: 'anthropic_api_key', severity: 'critical', regex: /\bsk-ant-[A-Za-z0-9_-]{20,}\b/g, keywords: ['anthropic', 'sk-ant'] },
  { id: 'google_api_key', severity: 'critical', regex: /\bAIza[0-9A-Za-z_-]{35}\b/g, keywords: ['google', 'AIza'] },
  { id: 'aws_access_key_id', severity: 'critical', regex: /\b(?:AKIA|ASIA|AIDA|AROA)[A-Z0-9]{16}\b/g, keywords: ['aws', 'akia'] },
  { id: 'aws_secret_access_key', severity: 'critical', regex: /\b[0-9A-Za-z/+]{40}\b/g, validator: 'highEntropy', keywords: ['aws', 'secret'] },
  { id: 'azure_storage_key', severity: 'critical', regex: /\b[A-Za-z0-9+/]{86}==\b/g, keywords: ['azure', 'storage'] },
  { id: 'stripe_live_secret_key', severity: 'critical', regex: /\bsk_live_[0-9a-zA-Z]{24,}\b/g, keywords: ['stripe', 'sk_live'] },
  { id: 'stripe_test_secret_key', severity: 'critical', regex: /\bsk_test_[0-9a-zA-Z]{24,}\b/g, keywords: ['stripe', 'sk_test'] },
  { id: 'stripe_live_publishable_key', severity: 'high', regex: /\bpk_live_[0-9a-zA-Z]{24,}\b/g, keywords: ['stripe', 'pk_live'] },
  { id: 'stripe_test_publishable_key', severity: 'medium', regex: /\bpk_test_[0-9a-zA-Z]{24,}\b/g, keywords: ['stripe', 'pk_test'] },
  { id: 'github_pat_classic', severity: 'critical', regex: /\bghp_[A-Za-z0-9]{36}\b/g, keywords: ['github', 'ghp_'] },
  { id: 'github_pat_fine_grained', severity: 'critical', regex: /\bgithub_pat_[A-Za-z0-9_]{22,}\b/g, keywords: ['github_pat_'] },
  { id: 'github_oauth_token', severity: 'critical', regex: /\bgho_[A-Za-z0-9]{36}\b/g, keywords: ['gho_'] },
  { id: 'github_user_token', severity: 'critical', regex: /\bghu_[A-Za-z0-9]{36}\b/g, keywords: ['ghu_'] },
  { id: 'github_refresh_token', severity: 'critical', regex: /\bghr_[A-Za-z0-9]{36}\b/g, keywords: ['ghr_'] },
  { id: 'gitlab_pat', severity: 'critical', regex: /\bglpat-[A-Za-z0-9_-]{20,}\b/g, keywords: ['gitlab', 'glpat-'] },
  { id: 'slack_bot_token', severity: 'critical', regex: /\bxoxb-\d{10,13}-\d{10,13}-[A-Za-z0-9]{24,}\b/g, keywords: ['xoxb-'] },
  { id: 'slack_user_token', severity: 'critical', regex: /\bxoxp-\d{10,13}-\d{10,13}-[A-Za-z0-9]{24,}\b/g, keywords: ['xoxp-'] },
  { id: 'slack_app_token', severity: 'critical', regex: /\bxoxa-[0-9A-Za-z-]{20,}\b/g, keywords: ['xoxa-'] },
  { id: 'slack_webhook', severity: 'critical', regex: /https:\/\/hooks\.slack\.com\/services\/[A-Za-z0-9/_-]{20,}/g, keywords: ['hooks.slack.com'] },
  { id: 'twilio_api_key', severity: 'critical', regex: /\bSK[0-9a-fA-F]{32}\b/g, keywords: ['twilio', 'sk'] },
  { id: 'twilio_account_sid', severity: 'high', regex: /\bAC[0-9a-fA-F]{32}\b/g, keywords: ['twilio', 'ac'] },
  { id: 'sendgrid_api_key', severity: 'critical', regex: /\bSG\.[A-Za-z0-9_-]{16,}\.[A-Za-z0-9_-]{16,}\b/g, keywords: ['sendgrid', 'SG.'] },
  { id: 'mailgun_api_key', severity: 'critical', regex: /\bkey-[0-9a-f]{32}\b/g, keywords: ['mailgun', 'key-'] },
  { id: 'npm_token', severity: 'critical', regex: /\bnpm_[A-Za-z0-9]{36}\b/g, keywords: ['npm_'] },
  { id: 'docker_pat', severity: 'critical', regex: /\bdckr_pat_[A-Za-z0-9_-]{20,}\b/g, keywords: ['dckr_pat_'] },
  { id: 'postman_api_key', severity: 'critical', regex: /\bPMAK-[A-Za-z0-9-]{20,}\b/g, keywords: ['PMAK-'] },
  { id: 'shopify_access_token', severity: 'critical', regex: /\bshpat_[A-Za-z0-9]{32}\b/g, keywords: ['shpat_'] },
  { id: 'airtable_token', severity: 'critical', regex: /\bpat[A-Za-z0-9]{14,}\.[A-Za-z0-9]{20,}\b/g, keywords: ['airtable', 'pat'] },
  { id: 'notion_secret', severity: 'critical', regex: /\bsecret_[A-Za-z0-9]{43}\b/g, keywords: ['notion', 'secret_'] },
  { id: 'linear_api_key', severity: 'critical', regex: /\blin_api_[A-Za-z0-9]{40,}\b/g, keywords: ['lin_api_'] },
  { id: 'datadog_api_key', severity: 'critical', regex: /\b[a-f0-9]{32}\b/g, keywords: ['datadog', 'api key'] },
  { id: 'sentry_dsn', severity: 'high', regex: /https:\/\/[a-f0-9]+@[a-z0-9.-]+\.ingest\.sentry\.io\/\d+/gi, keywords: ['sentry', 'ingest'] },
  { id: 'algolia_api_key', severity: 'critical', regex: /\b[A-Za-z0-9]{32}\b/g, keywords: ['algolia', 'api key'] },
  { id: 'segment_write_key', severity: 'high', regex: /\b[0-9a-f]{32}\b/g, keywords: ['segment', 'write key'] },
  { id: 'cloudflare_api_token', severity: 'critical', regex: /\b[A-Za-z0-9_-]{40}\b/g, keywords: ['cloudflare', 'token'] },
  { id: 'discord_bot_token', severity: 'critical', regex: /\b[A-Za-z\d_-]{24}\.[A-Za-z\d_-]{6}\.[A-Za-z\d_-]{27}\b/g, keywords: ['discord'] },
  { id: 'discord_webhook', severity: 'critical', regex: /https:\/\/discord(?:app)?\.com\/api\/webhooks\/\d+\/[A-Za-z0-9._-]+/g, keywords: ['discord', 'webhooks'] },
  { id: 'huggingface_token', severity: 'critical', regex: /\bhf_[A-Za-z0-9]{30,}\b/g, keywords: ['hf_'] },
  { id: 'openrouter_key', severity: 'critical', regex: /\bsk-or-v1-[A-Za-z0-9]{20,}\b/g, keywords: ['sk-or-v1-'] },
  { id: 'pinecone_api_key', severity: 'critical', regex: /\b[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}\b/gi, keywords: ['pinecone', 'api key'] },
  { id: 'assemblyai_key', severity: 'critical', regex: /\b[0-9a-f]{32}\b/g, keywords: ['assemblyai', 'api key'] },
  { id: 'vercel_token', severity: 'critical', regex: /\b[A-Za-z0-9]{24}\b/g, keywords: ['vercel', 'token'] },
  { id: 'firebase_server_key', severity: 'critical', regex: /\bAAAA[A-Za-z0-9_-]{7}:[A-Za-z0-9_-]{140}\b/g, keywords: ['firebase', 'AAAA'] },
  { id: 'mapbox_token', severity: 'high', regex: /\bpk\.[a-zA-Z0-9]{60,}\b/g, keywords: ['mapbox', 'pk.'] },
  { id: 'telegram_bot_token', severity: 'critical', regex: /\b\d{8,10}:[A-Za-z0-9_-]{35}\b/g, keywords: ['telegram', 'bot'] },
  { id: 'jwt_token', severity: 'high', regex: /\beyJ[A-Za-z0-9_-]{5,}\.[A-Za-z0-9_-]{10,}\.[A-Za-z0-9_-]{10,}\b/g, keywords: ['bearer', 'jwt'] },
  { id: 'bearer_token_long', severity: 'high', regex: /\bBearer\s+[A-Za-z0-9._-]{20,}\b/g, keywords: ['bearer'] },

  { id: 'pem_private_key_block', severity: 'critical', regex: /-----BEGIN PRIVATE KEY-----[\s\S]+?-----END PRIVATE KEY-----/g },
  { id: 'rsa_private_key_block', severity: 'critical', regex: /-----BEGIN RSA PRIVATE KEY-----[\s\S]+?-----END RSA PRIVATE KEY-----/g },
  { id: 'ec_private_key_block', severity: 'critical', regex: /-----BEGIN EC PRIVATE KEY-----[\s\S]+?-----END EC PRIVATE KEY-----/g },
  { id: 'openssh_private_key_block', severity: 'critical', regex: /-----BEGIN OPENSSH PRIVATE KEY-----[\s\S]+?-----END OPENSSH PRIVATE KEY-----/g },
  { id: 'pgp_private_key_block', severity: 'critical', regex: /-----BEGIN PGP PRIVATE KEY BLOCK-----[\s\S]+?-----END PGP PRIVATE KEY BLOCK-----/g },
  { id: 'google_service_account_private_key', severity: 'critical', regex: /"private_key"\s*:\s*"-----BEGIN PRIVATE KEY-----[\\n\s\S]+?-----END PRIVATE KEY-----\\n"/g },

  { id: 'email_address', severity: 'medium', regex: /\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}\b/g, keywords: ['@'] },
  { id: 'phone_us', severity: 'medium', regex: /\b(?:\+1[-.\s]?)?\(?[2-9]\d{2}\)?[-.\s]?\d{3}[-.\s]?\d{4}\b/g, keywords: ['phone', 'call'] },
  { id: 'phone_e164', severity: 'medium', regex: /\+[1-9]\d{7,14}\b/g, keywords: ['+'] },
  { id: 'ipv4_address', severity: 'low', regex: /\b(?:25[0-5]|2[0-4]\d|[0-1]?\d?\d)(?:\.(?:25[0-5]|2[0-4]\d|[0-1]?\d?\d)){3}\b/g, keywords: ['ip'] },
  { id: 'ipv6_address', severity: 'low', regex: /\b(?:[A-Fa-f0-9]{1,4}:){2,7}[A-Fa-f0-9]{1,4}\b/g, keywords: [':'] },
  { id: 'mac_address', severity: 'low', regex: /\b(?:[0-9A-Fa-f]{2}:){5}[0-9A-Fa-f]{2}\b/g, keywords: [':'] },
  { id: 'latitude_longitude', severity: 'low', regex: /\b-?(?:[1-8]?\d(?:\.\d+)?|90(?:\.0+)?),\s*-?(?:180(?:\.0+)?|(?:1[0-7]\d|\d?\d)(?:\.\d+)?)\b/g },
  { id: 'zip_us', severity: 'low', regex: /\b\d{5}(?:-\d{4})?\b/g, keywords: ['zip'] },
  { id: 'po_box', severity: 'medium', regex: /\bP\.?\s*O\.?\s*Box\s+\d+\b/gi, keywords: ['box'] },
  { id: 'date_of_birth', severity: 'medium', regex: /\b(?:19|20)\d{2}[-\/.](?:0?[1-9]|1[0-2])[-\/.](?:0?[1-9]|[12]\d|3[01])\b/g, keywords: ['dob', 'birth'] },
  { id: 'patient_id', severity: 'high', regex: /\b(?:patient|pt)[-_ ]?id[:# ]+[A-Z0-9]{6,20}\b/gi, keywords: ['patient'] },
  { id: 'insurance_policy_number', severity: 'high', regex: /\bpolicy[-_ ]?(?:number|no\.?)[ :#-]+[A-Z0-9-]{8,24}\b/gi, keywords: ['policy'] },
  { id: 'drivers_license_contextual', severity: 'high', regex: /\b(?:driver'?s?\s+license|dl)[:# ]+[A-Z0-9-]{6,20}\b/gi, keywords: ['license', 'dl'] },
  { id: 'tax_id_contextual', severity: 'high', regex: /\btax[-_ ]?(?:id|identifier)[:# ]+[A-Z0-9-]{8,20}\b/gi, keywords: ['tax'] },
  { id: 'bank_account_contextual', severity: 'high', regex: /\b(?:bank\s+account|acct)[:# ]+\d{8,20}\b/gi, keywords: ['account', 'bank'] },
  { id: 'passport_contextual', severity: 'high', regex: /\bpassport[:# ]+[A-Z0-9]{6,12}\b/gi, keywords: ['passport'] },
  { id: 'voter_id_india', severity: 'high', regex: /\b[A-Z]{3}\d{7}\b/g, keywords: ['voter'] },
  { id: 'upi_id', severity: 'medium', regex: /\b[a-zA-Z0-9._-]{2,}@[a-zA-Z]{2,}\b/g, keywords: ['upi'] },
  { id: 'license_plate_us', severity: 'low', regex: /\b[A-Z0-9]{1,3}-?[A-Z0-9]{3,6}\b/g, keywords: ['plate'] },
  { id: 'imei', severity: 'high', regex: /\b\d{15}\b/g, validator: 'luhn', keywords: ['imei'] },
  { id: 'imsi', severity: 'high', regex: /\b\d{15}\b/g, keywords: ['imsi'] },
  { id: 'credit_card_cvv_context', severity: 'high', regex: /\b(?:cvv|cvc|security code)[:# ]+\d{3,4}\b/gi, keywords: ['cvv', 'cvc'] },
  { id: 'account_pin_context', severity: 'high', regex: /\b(?:pin|otp)[:# ]+\d{4,8}\b/gi, keywords: ['pin', 'otp'] },
  { id: 'passport_mrz_line', severity: 'high', regex: /\bP<[A-Z<]{3}[A-Z<]{39}\b/g, keywords: ['P<'] },
];

module.exports = {
  PATTERN_DEFINITIONS,
};
