version: 1
mode: monitor

proxy:
  host: 127.0.0.1
  port: 8787
  timeout_ms: 30000

runtime:
  fail_open: false
  scanner_error_action: allow
  upstream:
    retry:
      enabled: true
      max_attempts: 1
      allow_post_with_idempotency_key: false
    circuit_breaker:
      enabled: true
      window_size: 20
      min_failures_to_evaluate: 8
      failure_rate_threshold: 0.5
      consecutive_timeout_threshold: 5
      open_seconds: 20
      half_open_success_threshold: 3

pii:
  enabled: true
  max_scan_bytes: 262144
  severity_actions:
    critical: block
    high: block
    medium: redact
    low: log

rules:
  - name: block-destructive-delete
    match:
      method: DELETE
      domain: "*.production.com"
    action: block
    message: "DELETE operations blocked for production domains"

  - name: max-upload-size
    match:
      method: POST
      body_size_mb: 10
    action: block
    message: "Payload too large"

  - name: block-shell-tool
    match:
      tool_name: execute_shell
    action: block
    message: "execute_shell tool is blocked"

whitelist:
  domains:
    - api.openai.com
    - api.anthropic.com
    - generativelanguage.googleapis.com

logging:
  level: info
  audit_file: ~/.sentinel/audit.jsonl
